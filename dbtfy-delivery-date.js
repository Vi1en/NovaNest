customElements.get("dbtfy-cart-delivery-calendar")||customElements.define("dbtfy-cart-delivery-calendar",class extends HTMLElement{constructor(){super(),this.data=Debutify.widgets["dbtfy-delivery-date"],this.init()}init(){if(this.data.length===0){this.remove();return}this.data.dbtfy_delivery_date_required_checkout&&(Debutify.checkout["dbtfy-delivery-date"]=!1,checkoutButtonHandler());const{Calendar}=window.VanillaCalendarPro,iniDate=this.formateDate(Debutify.cart.attributes.delivery_date);if(iniDate&&iniDate!=="NaN-NaN-NaN"){this.current_day=iniDate;const date=new Date(this.current_day),options2={year:"numeric",month:"long",day:"numeric"},formattedDate=date.toLocaleDateString("en-US",options2);this.querySelector(".dbtfy-cart-delivery-calendar-show").textContent=formattedDate,this.data.dbtfy_delivery_date_required_checkout&&(Debutify.checkout["dbtfy-delivery-date"]=!0,checkoutButtonHandler())}else this.current_day=new Date().toISOString().split("T")[0];this.day=new Date().toISOString().split("T")[0];const disabledDaysList=this.data.dbtfy_delivery_date_exclude_days.split(",").map(day=>day.trim().toUpperCase()),dayMap={SUN:0,MON:1,TUE:2,WED:3,THU:4,FRI:5,SAT:6},disabledDays=disabledDaysList.map(day=>dayMap[day]),options={onClickDate:(self,event)=>{const selectedDate=event.target.ariaLabel;selectedDate&&this.handleDateSelection(selectedDate)},selectedTheme:"light",dateMin:this.day,dateToday:this.current_day,disableDates:this.getDisabledDates(disabledDays),displayDateMax:new Date(new Date().getFullYear()+100,11,31).toISOString().split("T")[0]};this._calendar=this.querySelector(".dbtfy-calendar"),this.calendar=new Calendar(this._calendar,options),this.calendar.init()}getDisabledDates(disabledDays){const disabledDates=[],startDate=new Date,currentYear=new Date().getFullYear(),endDate=new Date(currentYear+100,11,31);for(let date=startDate;date<=endDate;date.setDate(date.getDate()+1)){const dayOfWeek=date.getDay();if(disabledDays.includes(dayOfWeek)){const disabledDate=date.toISOString().split("T")[0];disabledDates.push(disabledDate)}}return disabledDates}handleDateSelection(selectedDate){this.querySelector(".dbtfy-cart-delivery-calendar-show").textContent=selectedDate,this.updateCartDeliveryDate(selectedDate),this.calendar.dateToday=this.formateDate(selectedDate)}formateDate(selectedDate){const date=new Date(selectedDate),year=date.getFullYear(),month=String(date.getMonth()+1).padStart(2,"0"),day=String(date.getDate()).padStart(2,"0");return`${year}-${month}-${day}`}async updateCartDeliveryDate(deliveryDate){const cartUpdateData={attributes:{delivery_date:deliveryDate}};try{const cart=await(await fetch(`${window.routes.cart_update_url}.js`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(cartUpdateData)})).json();publish(PUB_SUB_EVENTS.cartUpdate,{source:"cart-items",cartData:cart}),this.data.dbtfy_delivery_date_required_checkout&&(Debutify.checkout["dbtfy-delivery-date"]=!0,checkoutButtonHandler())}catch(error){console.error("Error updating cart:",error)}}});
//# sourceMappingURL=/s/files/1/0643/2004/5130/t/2/assets/dbtfy-delivery-date.js.map?v=13673461748783412661744962460
