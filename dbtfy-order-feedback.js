customElements.get("order-feedback")||customElements.define("order-feedback",class extends HTMLElement{constructor(){super(),this.data=Debutify.widgets["dbtfy-order-feedback"],this.event=this.data?this.dataGet():!1,this.cartFetch(),this.selectElement=this.querySelector(".order-feedback-select"),this.inputElement=this.querySelector(".order-feedback-input"),this.orderFeedback=this.querySelector(".dbtfy-order-feedback-show"),this.required=this.data.dbtfy_order_feedback_required,this.required&&(Debutify.cart.attributes[this.data.dbtfy_order_feedback_question]===void 0?Debutify.checkout["dbtfy-order-feedback"]=!1:Debutify.checkout["dbtfy-order-feedback"]=!0,checkoutButtonHandler(),this.selectElement.addEventListener("change",()=>{Debutify.checkout["dbtfy-order-feedback"]=!0,checkoutButtonHandler()}))}dataGet(){const selectElement=this.querySelector("#order-feedback-select"),dbtfy_order_feedback_option=this.data.dbtfy_order_feedback_option;if(dbtfy_order_feedback_option!==""){var order_feedback_options=dbtfy_order_feedback_option.split(",");order_feedback_options.forEach(optionText=>{const option=document.createElement("option");option.value=optionText.toLowerCase(),option.textContent=optionText,selectElement.appendChild(option)})}return!!(order_feedback_options&&order_feedback_options.length>0&&this.data.dbtfy_order_feedback_question)}connectedCallback(){this.event?this.selectElement.addEventListener("change",this.toggleInput.bind(this)):this.remove()}cartFetch(){setTimeout(()=>{Debutify.cart.attributes[this.data.dbtfy_order_feedback_question]&&(this.orderFeedback.textContent=this.capitalizeEachWord(Debutify.cart.attributes[this.data.dbtfy_order_feedback_question]),this.selectElement.querySelector('option[value="'+Debutify.cart.attributes[this.data.dbtfy_order_feedback_question]+'"]')?(this.selectElement.value=Debutify.cart.attributes[this.data.dbtfy_order_feedback_question],this.orderFeedback.textContent=this.capitalizeEachWord(Debutify.cart.attributes[this.data.dbtfy_order_feedback_question])):(this.orderFeedback.textContent="Other",this.selectElement.value="other",this.inputElement.value=Debutify.cart.attributes[this.data.dbtfy_order_feedback_question],this.inputElement.classList.remove("hidden"),this.inputElement.focus(),this.inputElement.addEventListener("input",this.logInputValue.bind(this))))},100)}capitalizeEachWord(str){return str.replace(/\b\w/g,char=>char.toUpperCase())}toggleInput(){const selectedValue=this.selectElement.value.trim();this.orderFeedback.textContent=this.capitalizeEachWord(selectedValue),selectedValue.toLowerCase()==="other"?(this.inputElement.classList.remove("hidden"),this.inputElement.focus(),this.inputElement.addEventListener("input",this.logInputValue.bind(this))):(this.inputElement.classList.add("hidden"),this.updateCartFeedback(selectedValue))}logInputValue(){setTimeout(()=>{const selectedValue=this.inputElement.value;this.updateCartFeedback(selectedValue)},1e3)}async updateCartFeedback(selectedValue){const cartUpdateData={attributes:{[this.data.dbtfy_order_feedback_question]:selectedValue}};try{const response=await fetch(`${window.routes.cart_update_url}.js`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(cartUpdateData)})}catch(error){console.error("Error updating cart:",error)}}});
//# sourceMappingURL=/s/files/1/0643/2004/5130/t/2/assets/dbtfy-order-feedback.js.map?v=37612885841222290551744962460
