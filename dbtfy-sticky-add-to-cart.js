customElements.get("dbtfy-addtocart-sticky")||customElements.define("dbtfy-addtocart-sticky",class extends HTMLElement{constructor(){super(),this.testMode=Shopify.designMode,this.selectEvent=null,this.deselectEvent=null,this.toast=null,this.variantSelector=this.querySelector('select[name="id"]'),this.mainVariantInput=document.querySelector('.product .product-form input[name="id"]'),this.triggerType=this.dataset.triggerType,this.scrollDepth=parseInt(this.dataset.scrollDepth),this.hasOnlyDefaultVariant=this.dataset.hasOnlyDefaultVariant==="true",this.position=this.dataset.position,this.colorScheme=this.dataset.colorScheme,this.showon=this.dataset.showon,this.CustomColorScheme=this.dataset.customColorScheme,this.addtocartSimplified=this.dataset.addtocartSimplified,this.variantSelector?.addEventListener("change",event=>{this.onVariantChange(event)}),this.mainVariantInput?.addEventListener("change",event=>{this.onMainProductFormVariantChange(event)}),this.backToTop=document.querySelector("back-to-top")}connectedCallback(){this.testMode?(this.selectEvent=subscribe(PUB_SUB_EVENTS.stickyAddToCartSelect,e=>{this.show()}),this.deselectEvent=subscribe(PUB_SUB_EVENTS.stickyAddToCartDeselect,e=>{this.toast?.hideToast()})):this.init()}disconnectedCallback(){this.testMode&&(this.toast?.destroyToast(),this.selectEvent(),this.deselectEvent())}show(){let toastClass=`dbtfy-addtocart-sticky show-on--${this.showon}`;this.position==="top"&&(toastClass+=" dbtfy-addtocart-sticky-top"),window.innerWidth<750&&(this.addtocartSimplified==="true"?(toastClass+=" dbtfy-addtocart-simplified",this.backToTop&&this.backToTop.style.setProperty("--dbtfy-btt-bottom-margin","10rem")):this.backToTop&&this.backToTop.style.setProperty("--dbtfy-btt-bottom-margin","15rem"));const toastOptions={position:`${this.position}-center`,maxWidth:"100%",className:toastClass,colorScheme:this.colorScheme,customColorScheme:this.CustomColorScheme};this.toast=new Debutify.toast(this.innerHTML,toastOptions)}init(){const totalScrollHeight=document.body.scrollHeight-window.innerHeight,scrollDepthTrigger=this.scrollDepth/100*totalScrollHeight;window.addEventListener("scroll",()=>{const topThreshold=document.querySelector(".product product-form").getBoundingClientRect().bottom,scrollPosition=window.scrollY;this.triggerType==="scroll"&&0>topThreshold||this.triggerType==="scroll_depth"&&scrollPosition>=scrollDepthTrigger?this.toast||this.show():(this.toast?.destroyToast(),this.toast=null)})}onVariantChange(event){event.preventDefault();const imgSrc=this.variantSelector.options[this.variantSelector.selectedIndex].dataset.variantImg;if(imgSrc){const img=this.querySelector(".dbtfy-addtocart-sticky-img");img&&(img.src=imgSrc)}}onMainProductFormVariantChange(){this.variantSelector.value=this.mainVariantInput.value,this.variantSelector.dispatchEvent(new Event("change"))}});
//# sourceMappingURL=/s/files/1/0643/2004/5130/t/2/assets/dbtfy-sticky-add-to-cart.js.map?v=166471215893018783991744962461
