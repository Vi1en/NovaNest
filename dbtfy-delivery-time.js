customElements.get("dbtfy-cart-delivery-time")||customElements.define("dbtfy-cart-delivery-time",class extends HTMLElement{constructor(){super(),this.data=Debutify.widgets["dbtfy-delivery-time"],this.data&&this.data.dbtfy_delivery_time_heading?this.init():this.remove()}init(){this.data.dbtfy_delivery_time_required_checkout&&(Debutify.checkout["dbtfy-delivery-date"]=!1,checkoutButtonHandler());const{Calendar}=window.VanillaCalendarPro;this.deliveryTimeInput=this.querySelector(".dbtfy-cart-delivery-time"),this.calendar=new Calendar(this.deliveryTimeInput,this.getTimeOptions()),this.calendar.init(),this.timeShow=this.querySelector(".dbtfy-cart-delivery-time-show"),this.populateTime()}populateTime(){const debutifyTime=Debutify.cart?.attributes?.delivery_time||"";debutifyTime&&(this.timeShow.textContent=debutifyTime,this.data.dbtfy_delivery_time_required_checkout&&(Debutify.checkout["dbtfy-delivery-date"]=!0,checkoutButtonHandler()))}getTimeOptions(){const selectedTime=Debutify.cart?.attributes?.delivery_time||"",dbtfyDeliveryTime=this;return this.data.dbtfy_delivery_time_min?this.data.dbtfy_delivery_time_min=Math.abs(this.data.dbtfy_delivery_time_min):this.data.dbtfy_delivery_time_min=0,this.data.dbtfy_delivery_time_max?this.data.dbtfy_delivery_time_max=Math.abs(this.data.dbtfy_delivery_time_max):this.data.dbtfy_delivery_time_max=23,{layouts:{default:"<#ControlTime />"},selectedTheme:"light",timeMinHour:this.data.dbtfy_delivery_time_min,timeMaxHour:this.data.dbtfy_delivery_time_max,selectionTimeMode:12,selectedTime,onChangeTime(self){dbtfyDeliveryTime.updateCartDeliveryTime(self.context.selectedTime)}}}async updateCartDeliveryTime(deliveryTime){const cartUpdateData={attributes:{delivery_time:deliveryTime}};this.abortController&&this.abortController.abort(),this.abortController=new AbortController;try{const cart=await(await fetch(`${window.routes.cart_update_url}.js`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(cartUpdateData),signal:this.abortController.signal})).json();publish(PUB_SUB_EVENTS.cartUpdate,{source:"cart-items",cartData:cart}),this.timeShow.textContent=deliveryTime,this.data.dbtfy_delivery_time_required_checkout&&(Debutify.checkout["dbtfy-delivery-date"]=!0,checkoutButtonHandler())}catch(error){error.name!=="AbortError"&&console.error("Error updating cart:",error)}}});
//# sourceMappingURL=/s/files/1/0643/2004/5130/t/2/assets/dbtfy-delivery-time.js.map?v=118088479725510471301744962460
